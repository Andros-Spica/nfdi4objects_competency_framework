# Analysis

```{r, echo=FALSE}
directory = "data/lehrangebote"
```
```{r, echo=FALSE}
source(file = "source/IANUS_loadJSONs.R")

ianus <- IANUS_loadJSONs(directory = directory)
ianus <- as.data.frame(ianus)
```

```{r, echo=FALSE}
source(file = "source/IANUS_catchKeywords.R")

keywords <- IANUS_catchKeywords(ianus)
```

```{r, echo=FALSE}
keywords_unlisted <- unlist(keywords)
keywords_unlisted <- keywords_unlisted[keywords_unlisted != "NA"]
keyword_freq_sorted <- sort(table(keywords_unlisted), decreasing = TRUE)
```

```{r, echo=FALSE}
keyword_top <- keyword_freq_sorted[1:30]

par(mar = c(7, 4, 2, 2) + 0.2, cex.axis = 0.7)

barplot(keyword_top, 
        las = 2,
        col ="lightblue", 
        main ="Most frequent keywords (Inhalte)",
        ylab = "Frequency",
        xaxt="n", space = 1)

end_point = 0.5 + nrow(keyword_top) + nrow(keyword_top) - 1

text(seq(1.5, end_point, by = 2), par("usr")[3]-0.25, 
     srt = 60, adj = 1, xpd = TRUE,
     labels = paste(names(keyword_top)), cex = 0.65)
```

```{r, echo=FALSE, fig.height=6, fig.width=6}
library(wordcloud) 

par(mar = rep(0, 4))
wordcloud(words = names(keyword_freq_sorted), freq = keyword_freq_sorted, min.freq = 1,
          max.words=200, random.order=FALSE, rot.per=0.35, 
          scale = c(3, .3),
          colors=brewer.pal(8, "Set1"))
```

